!function e(t,n,r){function o(s,i){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!i&&a)return a(s,!0);if(u)return u(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var u="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}},o=e("./API"),u=r(o),s=e("./auth"),i=r(s),a=e("./balance"),l=r(a),c=e("./expense"),f=r(c),d=e("./filters"),p=e("./history"),h=r(p),v=e("./login"),y=r(v),_=e("./ls"),g=r(_),b=e("./main"),m=r(b),x=e("./pubsub"),M=r(x),j=e("./register"),O=r(j),L=e("./user"),P=r(L);angular.module("flatdosh",["templates","ui.bootstrap"]).factory("API",["$http","$window",u["default"]]).factory("auth",["ls",i["default"]]).factory("balance",["API",l["default"].factory]).factory("expense",["API","pubsub",f["default"].factory]).factory("login",["API","ls","pubsub",y["default"].factory]).factory("ls",[g["default"]]).factory("pubsub",[M["default"]]).factory("register",["API",O["default"].factory]).factory("user",[P["default"].factory]).controller("balanceCtrl",["balance","pubsub",l["default"].ctrl]).controller("expenseCtrl",["expense","pubsub",f["default"].ctrl]).controller("loginCtrl",["login","register",y["default"].ctrl]).controller("historyCtrl",["expense","pubsub","ls",h["default"].ctrl]).controller("mainCtrl",["ls","pubsub",m["default"]]).controller("userCtrl",["user",P["default"].ctrl]).config(["$httpProvider",function(e){["auth"].forEach(function(t){return e.interceptors.push(t)}),e.defaults.headers["delete"]={"Content-Type":"application/json"}}]).filter("money",d.money)},{"./API":7,"./auth":8,"./balance":11,"./expense":14,"./filters":15,"./history":17,"./login":20,"./ls":21,"./main":22,"./pubsub":23,"./register":25,"./user":28}],2:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function u(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!u(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,u,a,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],i(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,u=new Array(r-1),a=1;r>a;a++)u[a-1]=arguments[a];n.apply(this,u)}else if(s(n)){for(r=arguments.length,u=new Array(r-1),a=1;r>a;a++)u[a-1]=arguments[a];for(l=n.slice(),r=l.length,a=0;r>a;a++)l[a].apply(this,u)}return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var n;n=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,u,i;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],u=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(i=u;i-->0;)if(n[i]===t||n[i].listener&&n[i].listener===t){r=i;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?o(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,n){t.exports=e("./lib")},{"./lib":4}],4:[function(e,t,n){"use strict";function r(e){return{get:function(t){var n=e?""+e+"."+t:t,r=JSON.parse(localStorage.getItem(n))||{},o=r.val,u=r.type;return"date"===u?new Date(o):o},set:function(t,n){var r=e?""+e+"."+t:t,u=JSON.stringify({val:n,type:o.getType(n)});return localStorage.setItem(r,u)},drop:function(t){return localStorage.removeItem(e?""+e+"."+t:t)}}}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=e("js-type-check");t.exports=n["default"]},{"js-type-check":5}],5:[function(e,t,n){t.exports=e("./lib/typecheck")},{"./lib/typecheck":6}],6:[function(e,t,n){"use strict";function r(e){return Number.isFinite(e)}function o(e){return"string"==typeof e}function u(e){return"boolean"==typeof e}function s(e){return e instanceof RegExp}function i(e){return e instanceof Date}function a(e){return Array.isArray(e)}function l(e){return null===e}function c(e){return void 0===e}function f(e){return!c(e)}function d(e){return"function"==typeof e}function p(e){return e?"Object"===Object.prototype.toString.call(e).slice(8,-1):!1}function h(e){return e instanceof Error}function v(e,t){var n=e.prototype.constructor.name.toLowerCase(),l={string:o,object:p,number:r,"boolean":u,regexp:s,date:i,array:a,"function":d};return l[n](t)}function y(e){var t=Object.prototype.toString.call(e);return t.slice(8,-1).toLowerCase()}Object.defineProperty(n,"__esModule",{value:!0}),n.isNumber=r,n.isString=o,n.isBool=u,n.isRegex=s,n.isDate=i,n.isArray=a,n.isNull=l,n.isUndefined=c,n.isDefined=f,n.isFunction=d,n.isObject=p,n.isError=h,n.typeCheck=v,n.getType=y},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){var n="https://api.damonmcminn.com/flatdosh/";return{balance:function(){return e.get(n+"balance").success(function(e){return e.data})},expense:{save:function(t){return e({method:"post",url:""+n+"expense",data:t})},all:function(){return e.get(""+n+"expense")},destroy:function(t){return console.log(t),e({method:"delete",url:n+"expense",data:t})}},login:function(r){var o=r.email,u=r.password,s="Basic "+t.btoa(""+o+":"+u);return e({method:"post",url:""+n+"login",headers:{authorization:s}})},register:function(t){return e({method:"post",url:n+"register",data:t})}}},t.exports=n["default"]},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return{request:function(t){var n=/\/login$/.test(t.url);return n?t:(t.headers.authorization="Bearer "+e.get("token"),t)}}},t.exports=n["default"]},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){function n(){e.get().success(function(e){return r.balances=e})}var r=this;n(),t.sub("update balances",function(){n()})},t.exports=n["default"]},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return{get:function(){return e.balance().success(function(e){var t=e.reduce(function(e,t){return e.balance<t.balance?e:t});return t.balance<0&&(t.danger=!0),e.filter(function(e){return!e.danger&&e.balance<0}).forEach(function(e){e.balance===t.balance?e.danger=!0:e.warning=!0}),e.forEach(function(e){e.name=e.name.split("@").shift()}),e})}}},t.exports=n["default"]},{}],11:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./factory"),u=r(o),s=e("./ctrl"),i=r(s);n["default"]={ctrl:i["default"],factory:u["default"]},t.exports=n["default"]},{"./ctrl":9,"./factory":10}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){var n=this;t.pub("page","save"),n.save=function(){e.save(n.expense).then(function(){t.pub("update balances"),n.expense=null})}},t.exports=n["default"]},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){return{all:function(){return e.expense.all().then(function(e){return e.data})},save:function(t){return e.expense.save(t).then(function(e){return e.data})},destroy:function(t){return e.expense.destroy(t).then(function(e){return e.data})}}},t.exports=n["default"]},{}],14:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./factory"),u=r(o),s=e("./ctrl"),i=r(s);n["default"]={ctrl:i["default"],factory:u["default"]},t.exports=n["default"]},{"./ctrl":12,"./factory":13}],15:[function(e,t,n){"use strict";function r(){return function(e){var t=+e;return 0>t?"-£"+(-t).toFixed(2):"£"+t.toFixed(2)}}Object.defineProperty(n,"__esModule",{value:!0}),n.money=r},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n){function r(){e.all().then(function(e){o.history=e})}var o=this,u=n.get("user").id;o.user=u,o.history=[],o.checkDeletion=function(e){var t=o.history[e].shareId;t&&o.history.filter(function(e){return e.user!==u&&e.shareId===t}).forEach(function(e){return e["delete"]=!e["delete"]})},r(),t.sub("update balances",function(e){return"history"===e?!1:r()}),o.deleteExpenses=function(){var n=o.history.filter(function(e){return e["delete"]}).map(function(e){return e.id});e.destroy(n).then(function(e){t.pub("update balances","history"),e.deleted.forEach(function(e){o.history.forEach(function(t){t.id===e&&(t.deleted=!0)})})})}},t.exports=n["default"]},{}],17:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./ctrl"),u=r(o);n["default"]={ctrl:u["default"]},t.exports=n["default"]},{"./ctrl":16}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){var n=this;n.selectLogin=!0;var r={login:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e["do"](n.user).error(function(e){var t=void 0;switch(t=e&&e.message?e.message:"Server error",n.error=t,t){case"Bad password":n.user.password=null;break;case"User not found":n.user=null}})}),register:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){t["do"](n.user).success(function(){r.login()}).error(function(e){return console.log(e)})})};n.select=function(e){n.action=e},n.submit=function(){r[n.action]()}},t.exports=n["default"]},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n){return{"do":function(r){return e.login(r).success(function(e){return t.set("token",e.token),t.set("user",e.data),n.pub("login",!0),null})}}},t.exports=n["default"]},{}],20:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./factory"),u=r(o),s=e("./ctrl"),i=r(s);n["default"]={ctrl:i["default"],factory:u["default"]},t.exports=n["default"]},{"./ctrl":18,"./factory":19}],21:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("ls-wrapper"),u=r(o);n["default"]=function(){return u["default"]("flatdosh")},t.exports=n["default"]},{"ls-wrapper":3}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){var n=this,r=e.get("user");if(r){var o=r.name;n.name=o}n.change=function(e){n.toggleCollapsed(),n.page=e},t.sub("page",function(e){return n.page=e}),t.sub("login",function(t){if(t){n.loggedIn=!0;var r=e.get("user"),o=r.name;n.name=o}}),n.loggedIn=!!e.get("token"),n.logout=function(){e.drop("token"),e.drop("user"),n.loggedIn=!1},n.collapsed=!0,n.toggleCollapsed=function(){n.collapsed=!n.collapsed}},t.exports=n["default"]},{}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("events"),o=new r.EventEmitter;n["default"]=function(){return{sub:o.on,pub:o.emit}},t.exports=n["default"]},{events:2}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return{"do":function(t){return e.register(t)}}},t.exports=n["default"]},{}],25:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./factory"),u=r(o);n["default"]={factory:u["default"]},t.exports=n["default"]},{"./factory":24}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){var e=this;e.loggedIn=!1},t.exports=n["default"]},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return{}},t.exports=n["default"]},{}],28:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./factory"),u=r(o),s=e("./ctrl"),i=r(s);n["default"]={ctrl:i["default"],factory:u["default"]},t.exports=n["default"]},{"./ctrl":26,"./factory":27}]},{},[1]);
//# sourceMappingURL=bundle.js.map